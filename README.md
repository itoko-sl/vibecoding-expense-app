# 経費管理システム (Expense Management System)

企業向けの包括的な経費申請・承認・管理を行うWebアプリケーションです。Next.js、TypeScript、Tailwind CSSを使用し、役割ベースのアクセス制御と完全なワークフローを実装しています。

## 🚀 主要機能

### � 認証・役割管理
- **ユーザー認証システム** - ログイン・ログアウト機能
- **役割ベースアクセス制御** - 社員/承認者/Admin の3つの役割
- **権限管理** - 機能ごとの適切なアクセス制限

### �📊 ダッシュボード（データ可視化）
- **統合ダッシュボード** - 経費データの包括的な概要
- **インタラクティブチャート** - Recharts による美しいグラフ表示
  - 月別経費推移（折れ線グラフ）
  - カテゴリ別分布（円グラフ）
  - ステータス別経費（棒グラフ）
- **リアルタイム統計** - 今月の総額、前月比、申請中件数
- **KPI表示** - 重要指標の可視化

### 📋 経費管理
- **経費一覧表示** - 包括的な経費データ管理
- **ステータス管理** - 申請中/承認済み/差し戻し の状態管理
- **詳細情報モーダル** - 各経費の詳細情報表示
- **編集機能** - 差し戻された経費の再編集
- **検索・フィルタリング** - 効率的なデータ検索

### ➕ 経費申請（ファイルアップロード対応）
- **包括的申請フォーム** - 必要な全情報の入力
- **ファイルアップロード機能** - レシート画像の添付
  - 画像ファイル対応（JPG, PNG, GIF, WebP）
  - ファイルサイズ制限（5MB）
  - 自動ファイル名生成
  - ローカルストレージ保存（`public/uploads/receipts/`）
- **リアルタイムバリデーション** - 入力値の即座チェック
- **カテゴリ選択** - 8種類の経費カテゴリ

### ✅ 承認ワークフロー
- **承認者専用ページ** - 承認待ち経費の管理
- **一括承認機能** - 効率的な承認処理
- **差し戻し機能** - 理由付きで経費を差し戻し
- **承認履歴** - 承認・差し戻しの履歴管理

### ⚙️ 管理者機能
- **システム管理** - 全体的なシステム管理
- **ユーザー管理** - 全ユーザーの管理・監視
- **統計レポート** - 組織全体の経費分析
- **データ管理** - 全経費データへのアクセス

## 🛠 技術スタック

### フロントエンド
- **Next.js 15.5.0** - React フレームワーク（App Router）
- **TypeScript 5** - 型安全性とコード品質
- **Tailwind CSS 4** - ユーティリティファーストCSS
- **React Hook Form** - 効率的なフォーム管理
- **Recharts** - データ可視化ライブラリ
- **Lucide React** - 美しいアイコンセット
- **date-fns** - 日付操作ライブラリ

### バックエンド・API
- **Next.js API Routes** - サーバーサイド API
- **ファイルシステム API** - ローカルファイルストレージ
- **FormData処理** - マルチパートファイルアップロード

### 開発・品質管理
- **ESLint** - コード品質管理
- **TypeScript strict mode** - 厳密な型チェック
- **Git** - バージョン管理

## 👥 ユーザー役割

### 🟢 社員（Employee）
- 経費申請の作成・編集
- 自分の経費一覧の確認
- 差し戻された経費の再申請
- ダッシュボードでの個人統計確認

### 🟡 承認者（Approver）
- 社員機能 + 承認者専用機能
- 経費申請の承認・差し戻し
- 承認待ち経費の管理
- 部門統計の確認

### 🔴 管理者（Admin）
- 全機能へのアクセス
- システム全体の管理
- 全ユーザーの管理
- 組織全体の統計・レポート

## 🏗 セットアップ

### 前提条件
- Node.js 18.0.0 以上
- npm または yarn

### インストール手順

1. **リポジトリをクローン**:
```bash
git clone https://github.com/itoko-sl/vibecoding-expense-app.git
cd vibecoding-expense-app
```

2. **依存関係をインストール**:
```bash
npm install
```

3. **アップロードディレクトリを作成**:
```bash
mkdir -p public/uploads/receipts
```

4. **開発サーバーを起動**:
```bash
npm run dev
```

5. **ブラウザでアクセス**: http://localhost:3000

## 🔑 デモアカウント

### 社員アカウント
- **メール**: tanaka@company.com  
- **パスワード**: password123  
- **役割**: 社員（経費申請のみ）

### 承認者アカウント  
- **メール**: sato@company.com  
- **パスワード**: password123  
- **役割**: 承認者（申請+承認）

### 管理者アカウント
- **メール**: admin@company.com  
- **パスワード**: admin123  
- **役割**: 管理者（全機能）

## 📁 プロジェクト構造

```
vibecoding-expense-app/
├── src/
│   ├── app/                    # Next.js App Router
│   │   ├── api/               # API Routes
│   │   │   └── upload/        # ファイルアップロード API
│   │   ├── page.tsx           # メインページ（ダッシュボード統合）
│   │   ├── layout.tsx         # アプリケーションレイアウト
│   │   ├── globals.css        # グローバルスタイル
│   │   └── favicon.ico        # ファビコン
│   ├── components/            # Reactコンポーネント
│   │   ├── ExpenseForm.tsx           # 経費申請フォーム
│   │   ├── ExpenseList.tsx           # 経費一覧表示
│   │   ├── ExpenseDashboard.tsx      # ダッシュボード統計
│   │   ├── ExpenseDetailModal.tsx    # 経費詳細モーダル
│   │   ├── LoginForm.tsx             # ログインフォーム
│   │   ├── Header.tsx                # ヘッダーコンポーネント
│   │   ├── RoleGuard.tsx             # 役割ベースアクセス制御
│   │   ├── ApprovalPage.tsx          # 承認者専用ページ
│   │   └── AdminPage.tsx             # 管理者専用ページ
│   ├── contexts/              # React Context
│   │   └── AuthContext.tsx           # 認証コンテキスト
│   └── types/                 # TypeScript型定義
│       ├── expense.ts                # 経費関連の型
│       └── user.ts                   # ユーザー関連の型
├── public/                    # 静的ファイル
│   ├── uploads/               # アップロードファイル
│   │   └── receipts/          # レシート画像保存先
│   └── *.svg                  # アイコン・画像
├── package.json               # 依存関係とスクリプト
├── tsconfig.json              # TypeScript設定
├── tailwind.config.ts         # Tailwind CSS設定
├── next.config.ts             # Next.js設定
└── README.md                  # このファイル
```

## 🎯 使用方法

### 1. ログイン
- デモアカウントでログイン
- 役割に応じた機能へアクセス

### 2. ダッシュボード
- 経費統計の確認
- グラフによるデータ可視化
- 月別・カテゴリ別分析

### 3. 経費申請
- 「経費登録」タブから新規申請
- レシート画像のアップロード
- 必要情報の入力と送信

### 4. 経費管理
- 「経費一覧」で申請状況確認
- 詳細情報の表示
- 差し戻し分の再編集

### 5. 承認業務（承認者・管理者）
- 「承認管理」で待機中申請を確認
- 承認または差し戻し処理
- 差し戻し理由の記入

### 6. システム管理（管理者）
- 「管理」タブでシステム全体を管理
- ユーザー情報の確認
- 組織全体の統計確認

## � 経費カテゴリ

| カテゴリ | 説明 | 例 |
|---------|------|-----|
| 交通費 | 移動にかかる費用 | 電車代、タクシー代、ガソリン代 |
| 宿泊費 | 出張時の宿泊費 | ホテル代、旅館代 |
| 食費 | 業務関連の食事代 | 会食費、出張中の食事 |
| 会議費 | 会議に関する費用 | 会議室利用料、お茶代 |
| 通信費 | 通信にかかる費用 | 携帯代、インターネット代 |
| 事務用品 | 事務用品の購入費 | 文具、コピー用紙 |
| 書籍・研修費 | 学習・研修費用 | 技術書、セミナー参加費 |
| その他 | 上記以外の経費 | その他業務関連費用 |

## 🔧 開発コマンド

### 開発サーバー起動
```bash
npm run dev
```

### プロダクションビルド
```bash
npm run build
```

### プロダクション起動
```bash
npm start
```

### 型チェック
```bash
npx tsc --noEmit
```

### リント実行
```bash
npm run lint
```

### リント修正
```bash
npm run lint:fix
```

## 🚀 デプロイ

### Vercel（推奨）
```bash
npm install -g vercel
vercel
```

### 他のプラットフォーム
1. `npm run build` でビルド
2. `.next` フォルダをデプロイ
3. Node.js 18+ 環境で実行

## 📝 ファイルアップロード仕様

### サポートファイル形式
- **画像**: JPG, JPEG, PNG, GIF, WebP
- **最大サイズ**: 5MB
- **保存先**: `public/uploads/receipts/`

### ファイル命名規則
```
receipt-{timestamp}-{randomId}.{extension}
例: receipt-1724467200000-abc123.jpg
```

## 🔒 セキュリティ

### 認証
- セッションベース認証
- ローカルストレージによる状態管理
- 役割ベースアクセス制御

### ファイルアップロード
- ファイル形式検証
- サイズ制限
- 安全なファイル名生成

### データ検証
- フロントエンド・バックエンド両方でバリデーション
- TypeScript による型安全性
- 入力値のサニタイズ

## 🌟 特徴

### ✨ ユーザーエクスペリエンス
- **直感的なUI** - 使いやすいインターフェース
- **レスポンシブデザイン** - モバイル・デスクトップ対応
- **リアルタイムフィードバック** - 即座な入力検証
- **美しいアニメーション** - スムーズな画面遷移

### 🔄 ワークフロー
- **完全な承認フロー** - 申請→承認→管理の完全なサイクル
- **差し戻し機能** - 理由付きで経費を差し戻し可能
- **ステータス管理** - 明確な進捗状況表示
- **履歴管理** - 全ての操作履歴を記録

### 📊 データ分析
- **包括的ダッシュボード** - 重要指標の可視化
- **インタラクティブチャート** - クリック可能なグラフ
- **期間比較** - 月次・年次の比較分析
- **カテゴリ分析** - 支出パターンの把握

### 🔧 技術的特徴
- **モダンスタック** - 最新技術による構築
- **型安全性** - TypeScript による完全な型管理
- **パフォーマンス** - 最適化されたローディング
- **拡張性** - 機能追加が容易な設計

## 🚧 今後の改善予定

### 短期的改善
- [ ] **データベース連携** - PostgreSQL/MySQL との接続
- [ ] **メール通知** - 承認・差し戻し時の自動通知
- [ ] **エクスポート機能** - CSV/PDF出力
- [ ] **高度な検索** - 期間・金額・カテゴリでの絞り込み

### 中期的改善  
- [ ] **API認証** - JWT ベースの認証システム
- [ ] **ファイル管理** - クラウドストレージ連携
- [ ] **レポート機能** - 詳細な分析レポート
- [ ] **予算管理** - 部門別予算設定・管理

### 長期的改善
- [ ] **多言語対応** - 国際化（i18n）
- [ ] **PWA化** - オフライン対応
- [ ] **AI機能** - レシート自動読み取り
- [ ] **モバイルアプリ** - React Native版

## 🐛 トラブルシューティング

### よくある問題

#### ❓ ファイルアップロードが失敗する
```bash
# アップロードディレクトリの権限確認
ls -la public/uploads/
chmod 755 public/uploads/receipts/
```

#### ❓ 開発サーバーが起動しない  
```bash
# ポート3000が使用中の場合
npx kill-port 3000
npm run dev
```

#### ❓ ビルドエラーが発生する
```bash
# 依存関係の再インストール
rm -rf node_modules package-lock.json
npm install
npm run build
```

#### ❓ 型エラーが発生する
```bash
# TypeScript の型チェック
npx tsc --noEmit
```

## 📄 ライセンス

MIT License - 詳細は [LICENSE](LICENSE) ファイルを参照してください。

## 🤝 コントリビューション

プロジェクトへの貢献を歓迎します！

### 貢献方法
1. **Fork** このリポジトリ
2. **Feature branch** を作成 (`git checkout -b feature/amazing-feature`)
3. **Commit** 変更内容 (`git commit -m 'Add amazing feature'`)
4. **Push** to branch (`git push origin feature/amazing-feature`)  
5. **Pull Request** を作成

### 開発ガイドライン
- TypeScript の型定義を適切に行う
- Tailwind CSS のユーティリティクラスを使用
- コンポーネントは再利用可能に設計
- 適切なコメントとドキュメント

## 🙏 謝辞

このプロジェクトの開発にあたり、以下のオープンソースプロジェクトを使用させていただきました：

- [Next.js](https://nextjs.org/) - React フレームワーク
- [Tailwind CSS](https://tailwindcss.com/) - CSS フレームワーク  
- [React Hook Form](https://react-hook-form.com/) - フォーム管理
- [Recharts](https://recharts.org/) - チャートライブラリ
- [Lucide](https://lucide.dev/) - アイコンライブラリ

## 📧 お問い合わせ

プロジェクトに関するご質問やフィードバックがございましたら、以下までお気軽にお知らせください：

- **GitHub Issues**: [Issues](https://github.com/itoko-sl/vibecoding-expense-app/issues)
- **Email**: [お問い合わせ先メールアドレス]
- **Documentation**: [プロジェクトWiki](https://github.com/itoko-sl/vibecoding-expense-app/wiki)

---

**🎉 ご利用ありがとうございます！** このシステムがあなたの経費管理業務の効率化に役立つことを願っています。
